# DERRYGREENAGH
S <- ggplot(Time, aes(Derrygreenagh)) +
geom_histogram() + labs(y= "Frequency", x = "Derrygreenagh (JJA, 1961-2006)") +
geom_point(aes(x=3.8, y=2.5),
shape = 21, colour = "black", fill = "red", size = 2.5, stroke =1.5)+
theme(text=element_text(family="Arial",face="bold", size=9))+
theme_bw()
# Mullingar
P <- ggplot(Time, aes(Mullingar)) +
geom_histogram() +labs(y= "Frequency", x = "Mullingar (JJA, 1974-2006)") +
geom_point(aes(x=3.7, y=2.5),
shape = 21, colour = "black", fill = "red", size = 2.5, stroke =1.5)+
theme(text=element_text(family="Arial",face="bold", size=9))+
theme_bw()
# Clonsast
R <- ggplot(Time, aes(Clonsast)) +
geom_histogram()  +labs(y= "Frequency", x = "Clonsast (JJA, 1961-1987)") +
geom_point(aes(x=1.7, y=2.5),
shape = 21, colour = "black", fill = "red", size = 2.5, stroke =1.5)+
theme(text=element_text(family="Arial",face="bold", size=9))+
theme_bw()
# Ballybrittas
A <- ggplot(Time, aes(Ballybrittas)) +
geom_histogram()  +labs(y= "Frequency", x = "Ballybrittas (JJA, 1964-1981)") +
geom_point(aes(x=0.5, y=2.5),
shape = 21, colour = "black", fill = "red", size = 2.5, stroke =1.5)+
theme(text=element_text(family="Arial",face="bold", size=9))+
theme_bw()
# Birr
A <- ggplot(Time, aes(Birr)) +
geom_histogram()  +labs(y= "Frequency", x = "Birr (JJA, 1961-2006)") +
geom_point(aes(x=0.5, y=2.5),
shape = 21, colour = "black", fill = "red", size = 2.5, stroke =1.5)+
theme(text=element_text(family="Arial",face="bold", size=9))+
theme_bw()
# Lanesboro
A <- ggplot(Time, aes(Lanesboro)) +
geom_histogram()  +labs(y= "Frequency", x = "Lanesboro (JJA, 1965-1997)") +
geom_point(aes(x=0.5, y=2.5),
shape = 21, colour = "black", fill = "red", size = 2.5, stroke =1.5)+
theme(text=element_text(family="Arial",face="bold", size=9))+
theme_bw()
# Thurles
A <- ggplot(Time, aes(Thurles)) +
geom_histogram()  +labs(y= "Frequency", x = "Thurles (JJA, 1961-1980)") +
geom_point(aes(x=0.5, y=2.5),
shape = 21, colour = "black", fill = "red", size = 2.5, stroke =1.5)+
theme(text=element_text(family="Arial",face="bold", size=9))+
theme_bw()
grid.arrange( a, b, c, d, e, f, g, nrow= 2, top = "")+
theme(text=element_text(family="Arial",face="bold", size=9))
# DERRYGREENAGH
a <- ggplot(Time, aes(Derrygreenagh)) +
geom_histogram() + labs(y= "Frequency", x = "Derrygreenagh (JJA, 1961-2006)") +
geom_point(aes(x=3.8, y=2.5),
shape = 21, colour = "black", fill = "red", size = 2.5, stroke =1.5)+
theme(text=element_text(family="Arial",face="bold", size=9))+
theme_bw()
# Mullingar
b <- ggplot(Time, aes(Mullingar)) +
geom_histogram() +labs(y= "Frequency", x = "Mullingar (JJA, 1974-2006)") +
geom_point(aes(x=3.7, y=2.5),
shape = 21, colour = "black", fill = "red", size = 2.5, stroke =1.5)+
theme(text=element_text(family="Arial",face="bold", size=9))+
theme_bw()
# Clonsast
c <- ggplot(Time, aes(Clonsast)) +
geom_histogram()  +labs(y= "Frequency", x = "Clonsast (JJA, 1961-1987)") +
geom_point(aes(x=1.7, y=2.5),
shape = 21, colour = "black", fill = "red", size = 2.5, stroke =1.5)+
theme(text=element_text(family="Arial",face="bold", size=9))+
theme_bw()
# Ballybrittas
d <- ggplot(Time, aes(Ballybrittas)) +
geom_histogram()  +labs(y= "Frequency", x = "Ballybrittas (JJA, 1964-1981)") +
geom_point(aes(x=0.5, y=2.5),
shape = 21, colour = "black", fill = "red", size = 2.5, stroke =1.5)+
theme(text=element_text(family="Arial",face="bold", size=9))+
theme_bw()
# Birr
e <- ggplot(Time, aes(Birr)) +
geom_histogram()  +labs(y= "Frequency", x = "Birr (JJA, 1961-2006)") +
geom_point(aes(x=0.5, y=2.5),
shape = 21, colour = "black", fill = "red", size = 2.5, stroke =1.5)+
theme(text=element_text(family="Arial",face="bold", size=9))+
theme_bw()
# Lanesboro
f <- ggplot(Time, aes(Lanesboro)) +
geom_histogram()  +labs(y= "Frequency", x = "Lanesboro (JJA, 1965-1997)") +
geom_point(aes(x=0.5, y=2.5),
shape = 21, colour = "black", fill = "red", size = 2.5, stroke =1.5)+
theme(text=element_text(family="Arial",face="bold", size=9))+
theme_bw()
# Thurles
g <- ggplot(Time, aes(Thurles)) +
geom_histogram()  +labs(y= "Frequency", x = "Thurles (JJA, 1961-1980)") +
geom_point(aes(x=0.5, y=2.5),
shape = 21, colour = "black", fill = "red", size = 2.5, stroke =1.5)+
theme(text=element_text(family="Arial",face="bold", size=9))+
theme_bw()
### combine them together
library(ggplot2)
grid.arrange( a, b, c, d, e, f, g, nrow= 2, top = "")+
theme(text=element_text(family="Arial",face="bold", size=9))
# DERRYGREENAGH
a <- ggplot(Time, aes(Derrygreenagh)) +
geom_histogram() + labs(y= "Frequency", x = "Derrygreenagh (JJA, 1961-2006)") +
geom_point(aes(x=3.8, y=2.5),
shape = 21, colour = "black", fill = "red", size = 2.5, stroke =1.5)+
theme(text=element_text(family="Arial",face="bold", size=9))+
theme_bw()
# Mullingar
b <- ggplot(Time, aes(Mullingar)) +
geom_histogram() +labs(y= "Frequency", x = "Mullingar (JJA, 1974-2006)") +
geom_point(aes(x=3.7, y=2.5),
shape = 21, colour = "black", fill = "red", size = 2.5, stroke =1.5)+
theme(text=element_text(family="Arial",face="bold", size=9))+
theme_bw()
# Clonsast
c <- ggplot(Time, aes(Clonsast)) +
geom_histogram()  +labs(y= "Frequency", x = "Clonsast (JJA, 1961-1987)") +
geom_point(aes(x=1.7, y=2.5),
shape = 21, colour = "black", fill = "red", size = 2.5, stroke =1.5)+
theme(text=element_text(family="Arial",face="bold", size=9))+
theme_bw()
# Ballybrittas
d <- ggplot(Time, aes(Ballybrittas)) +
geom_histogram()  +labs(y= "Frequency", x = "Ballybrittas (JJA, 1964-1981)") +
geom_point(aes(x=0.5, y=2.5),
shape = 21, colour = "black", fill = "red", size = 2.5, stroke =1.5)+
theme(text=element_text(family="Arial",face="bold", size=9))+
theme_bw()
# Birr
e <- ggplot(Time, aes(Birr)) +
geom_histogram()  +labs(y= "Frequency", x = "Birr (JJA, 1961-2006)") +
geom_point(aes(x=1.3, y=2.5),
shape = 21, colour = "black", fill = "red", size = 2.5, stroke =1.5)+
theme(text=element_text(family="Arial",face="bold", size=9))+
theme_bw()
# Lanesboro
f <- ggplot(Time, aes(Lanesboro)) +
geom_histogram()  +labs(y= "Frequency", x = "Lanesboro (JJA, 1965-1997)") +
geom_point(aes(x=2.3, y=2.5),
shape = 21, colour = "black", fill = "red", size = 2.5, stroke =1.5)+
theme(text=element_text(family="Arial",face="bold", size=9))+
theme_bw()
# Thurles
g <- ggplot(Time, aes(Thurles)) +
geom_histogram()  +labs(y= "Frequency", x = "Thurles (JJA, 1961-1980)") +
geom_point(aes(x=0.9, y=2.5),
shape = 21, colour = "black", fill = "red", size = 2.5, stroke =1.5)+
theme(text=element_text(family="Arial",face="bold", size=9))+
theme_bw()
### combine them together
library(ggplot2)
grid.arrange( a, b, c, d, e, f, g, nrow= 2, top = "")+
theme(text=element_text(family="Arial",face="bold", size=9))
png("ad.png", width = 9, height = 12, units = 'in', res = 300)
grid.arrange( a, b, c, d, e, f, g, nrow= 3, top = "")+
theme(text=element_text(family="Arial",face="bold", size=9))
df.melt <- melt(Time, id.vars=c("Year"))
TVB <- df.melt %>%
rename(
Station = variable
)
getwd()
H <- ggplot(TVB,
aes(x=value , y=Station)
) +
geom_density_ridges_gradient(
aes(fill = ..x..), scale = 3, size = 0.3
) +
scale_fill_gradientn(
colours = c(low = "white", high = "black"),
name = "Temp. [c]"
)+
ggtitle("") +
theme(plot.title = element_text(hjust = 0.5))+
theme(plot.title = element_text(hjust = 0.5))+
theme(text=element_text(family="Arial",face="bold", size=30))+
geom_point(aes(x=3.8, y=4.0),
shape = 21, colour = "black", fill = "red", size = 2.5, stroke =1.5)+
theme(text=element_text(family="Arial",face="bold", size=9))+
geom_point(aes(x=3.7, y=3.0),
shape = 21, colour = "black", fill = "red", size = 2.5, stroke =1.5)+
theme(text=element_text(family="Arial",face="bold", size=9))+
geom_point(aes(x=1.7, y=2.0),
shape = 21, colour = "black", fill = "red", size = 2.5, stroke =1.5)+
theme(text=element_text(family="Arial",face="bold", size=9))+
geom_point(aes(x=0.5, y=1.0),
shape = 21, colour = "black", fill = "red", size = 2.5, stroke =1.5)+
theme(text=element_text(family="Arial",face="bold", size=9))+
theme_bw()
### combine them together
library(ggplot2)
H <- ggplot(TVB,
aes(x=value , y=Station)
) +
geom_density_ridges_gradient(
aes(fill = ..x..), scale = 3, size = 0.3
) +
scale_fill_gradientn(
colours = c(low = "white", high = "black"),
name = "Temp. [c]"
)+
ggtitle("") +
theme(plot.title = element_text(hjust = 0.5))+
theme(plot.title = element_text(hjust = 0.5))+
theme(text=element_text(family="Arial",face="bold", size=30))+
geom_point(aes(x=3.8, y=4.0),
shape = 21, colour = "black", fill = "red", size = 2.5, stroke =1.5)+
theme(text=element_text(family="Arial",face="bold", size=9))+
geom_point(aes(x=3.7, y=3.0),
shape = 21, colour = "black", fill = "red", size = 2.5, stroke =1.5)+
theme(text=element_text(family="Arial",face="bold", size=9))+
geom_point(aes(x=1.7, y=2.0),
shape = 21, colour = "black", fill = "red", size = 2.5, stroke =1.5)+
theme(text=element_text(family="Arial",face="bold", size=9))+
geom_point(aes(x=0.5, y=1.0),
shape = 21, colour = "black", fill = "red", size = 2.5, stroke =1.5)+
theme(text=element_text(family="Arial",face="bold", size=9))+
theme_bw()
View(Time)
H <- ggplot(TVB,
aes(x=value , y=Station)
) +
geom_density_ridges_gradient(
aes(fill = ..x..), scale = 3, size = 0.3
) +
scale_fill_gradientn(
colours = c(low = "white", high = "black"),
name = "Temp. [c]"
)+
ggtitle("") +
theme(plot.title = element_text(hjust = 0.5))+
theme(plot.title = element_text(hjust = 0.5))+
theme(text=element_text(family="Arial",face="bold", size=30))+
geom_point(aes(x=3.8, y=4.0),
shape = 21, colour = "black", fill = "red", size = 2.5, stroke =1.5)+
theme(text=element_text(family="Arial",face="bold", size=9))+
geom_point(aes(x=3.7, y=3.0),
shape = 21, colour = "black", fill = "red", size = 2.5, stroke =1.5)+
theme(text=element_text(family="Arial",face="bold", size=9))+
geom_point(aes(x=1.7, y=2.0),
shape = 21, colour = "black", fill = "red", size = 2.5, stroke =1.5)+
theme(text=element_text(family="Arial",face="bold", size=9))+
geom_point(aes(x=0.5, y=1.0),
shape = 21, colour = "black", fill = "red", size = 2.5, stroke =1.5)+
theme(text=element_text(family="Arial",face="bold", size=9))+
geom_point(aes(x=1.3, y=1.0),
shape = 21, colour = "black", fill = "red", size = 2.5, stroke =1.5)+
theme(text=element_text(family="Arial",face="bold", size=9))+
geom_point(aes(x=2.3, y=1.0),
shape = 21, colour = "black", fill = "red", size = 2.5, stroke =1.5)+
theme(text=element_text(family="Arial",face="bold", size=9))+
geom_point(aes(x=0.9, y=1.0),
shape = 21, colour = "black", fill = "red", size = 2.5, stroke =1.5)+
theme(text=element_text(family="Arial",face="bold", size=9))+
theme_bw()
library(ggridges)
df.melt <- melt(Time, id.vars=c("Year"))
tail(df.melt)
TVB <- df.melt %>%
rename(
Station = variable
)
getwd()
H <- ggplot(TVB,
aes(x=value , y=Station)
) +
geom_density_ridges_gradient(
aes(fill = ..x..), scale = 3, size = 0.3
) +
scale_fill_gradientn(
colours = c(low = "white", high = "black"),
name = "Temp. [c]"
)+
ggtitle("") +
theme(plot.title = element_text(hjust = 0.5))+
theme(plot.title = element_text(hjust = 0.5))+
theme(text=element_text(family="Arial",face="bold", size=30))+
geom_point(aes(x=3.8, y=4.0),
shape = 21, colour = "black", fill = "red", size = 2.5, stroke =1.5)+
theme(text=element_text(family="Arial",face="bold", size=9))+
geom_point(aes(x=3.7, y=3.0),
shape = 21, colour = "black", fill = "red", size = 2.5, stroke =1.5)+
theme(text=element_text(family="Arial",face="bold", size=9))+
geom_point(aes(x=1.7, y=2.0),
shape = 21, colour = "black", fill = "red", size = 2.5, stroke =1.5)+
theme(text=element_text(family="Arial",face="bold", size=9))+
geom_point(aes(x=0.5, y=1.0),
shape = 21, colour = "black", fill = "red", size = 2.5, stroke =1.5)+
theme(text=element_text(family="Arial",face="bold", size=9))+
geom_point(aes(x=1.3, y=1.0),
shape = 21, colour = "black", fill = "red", size = 2.5, stroke =1.5)+
theme(text=element_text(family="Arial",face="bold", size=9))+
geom_point(aes(x=2.3, y=1.0),
shape = 21, colour = "black", fill = "red", size = 2.5, stroke =1.5)+
theme(text=element_text(family="Arial",face="bold", size=9))+
geom_point(aes(x=0.9, y=1.0),
shape = 21, colour = "black", fill = "red", size = 2.5, stroke =1.5)+
theme(text=element_text(family="Arial",face="bold", size=9))+
theme_bw()
H
Time <-read.csv("C:/Eire_Tmax_Investigation/Data_sets/Hist_Boora_New_Data.csv")
names(Time)
# DERRYGREENAGH
a <- ggplot(Time, aes(Derrygreenagh)) +
geom_histogram() + labs(y= "Frequency", x = "Derrygreenagh (JJA, 1961-2006)") +
geom_point(aes(x=3.8, y=2.5),
shape = 21, colour = "black", fill = "red", size = 2.5, stroke =1.5)+
theme(text=element_text(family="Arial",face="bold", size=9))+
theme_bw()
# Mullingar
b <- ggplot(Time, aes(Mullingar)) +
geom_histogram() +labs(y= "Frequency", x = "Mullingar (JJA, 1974-2006)") +
geom_point(aes(x=3.7, y=2.5),
shape = 21, colour = "black", fill = "red", size = 2.5, stroke =1.5)+
theme(text=element_text(family="Arial",face="bold", size=9))+
theme_bw()
# Clonsast
c <- ggplot(Time, aes(Clonsast)) +
geom_histogram()  +labs(y= "Frequency", x = "Clonsast (JJA, 1961-1987)") +
geom_point(aes(x=1.7, y=2.5),
shape = 21, colour = "black", fill = "red", size = 2.5, stroke =1.5)+
theme(text=element_text(family="Arial",face="bold", size=9))+
theme_bw()
# Ballybrittas
d <- ggplot(Time, aes(Ballybrittas)) +
geom_histogram()  +labs(y= "Frequency", x = "Ballybrittas (JJA, 1964-1981)") +
geom_point(aes(x=0.5, y=2.5),
shape = 21, colour = "black", fill = "red", size = 2.5, stroke =1.5)+
theme(text=element_text(family="Arial",face="bold", size=9))+
theme_bw()
# Birr
e <- ggplot(Time, aes(Birr)) +
geom_histogram()  +labs(y= "Frequency", x = "Birr (JJA, 1961-2006)") +
geom_point(aes(x=1.3, y=2.5),
shape = 21, colour = "black", fill = "red", size = 2.5, stroke =1.5)+
theme(text=element_text(family="Arial",face="bold", size=9))+
theme_bw()
# Lanesboro
f <- ggplot(Time, aes(Lanesboro)) +
geom_histogram()  +labs(y= "Frequency", x = "Lanesboro (JJA, 1965-1997)") +
geom_point(aes(x=2.3, y=2.5),
shape = 21, colour = "black", fill = "red", size = 2.5, stroke =1.5)+
theme(text=element_text(family="Arial",face="bold", size=9))+
theme_bw()
# Thurles
g <- ggplot(Time, aes(Thurles)) +
geom_histogram()  +labs(y= "Frequency", x = "Thurles (JJA, 1961-1980)") +
geom_point(aes(x=0.9, y=2.5),
shape = 21, colour = "black", fill = "red", size = 2.5, stroke =1.5)+
theme(text=element_text(family="Arial",face="bold", size=9))+
theme_bw()
### combine them together
library(ggplot2)
grid.arrange( a, b, c, d, e, f, g, nrow= 3, top = "")+
theme(text=element_text(family="Arial",face="bold", size=9))
library(ggridges)
df.melt <- melt(Time, id.vars=c("Year"))
tail(df.melt)
TVB <- df.melt %>%
rename(
Station = variable
)
getwd()
H <- ggplot(TVB,
aes(x=value , y=Station)
) +
geom_density_ridges_gradient(
aes(fill = ..x..), scale = 3, size = 0.3
) +
scale_fill_gradientn(
colours = c(low = "white", high = "black"),
name = "Temp. [c]"
)+
ggtitle("") +
theme(plot.title = element_text(hjust = 0.5))+
theme(plot.title = element_text(hjust = 0.5))+
theme(text=element_text(family="Arial",face="bold", size=30))+
geom_point(aes(x=3.8, y=4.0),
shape = 21, colour = "black", fill = "red", size = 2.5, stroke =1.5)+
theme(text=element_text(family="Arial",face="bold", size=9))+
geom_point(aes(x=3.7, y=3.0),
shape = 21, colour = "black", fill = "red", size = 2.5, stroke =1.5)+
theme(text=element_text(family="Arial",face="bold", size=9))+
geom_point(aes(x=1.7, y=2.0),
shape = 21, colour = "black", fill = "red", size = 2.5, stroke =1.5)+
theme(text=element_text(family="Arial",face="bold", size=9))+
geom_point(aes(x=0.5, y=1.0),
shape = 21, colour = "black", fill = "red", size = 2.5, stroke =1.5)+
theme(text=element_text(family="Arial",face="bold", size=9))+
geom_point(aes(x=1.3, y=1.0),
shape = 21, colour = "black", fill = "red", size = 2.5, stroke =1.5)+
theme(text=element_text(family="Arial",face="bold", size=9))+
geom_point(aes(x=2.3, y=1.0),
shape = 21, colour = "black", fill = "red", size = 2.5, stroke =1.5)+
theme(text=element_text(family="Arial",face="bold", size=9))+
geom_point(aes(x=0.9, y=1.0),
shape = 21, colour = "black", fill = "red", size = 2.5, stroke =1.5)+
theme(text=element_text(family="Arial",face="bold", size=9))+
theme_bw()
H
grid.arrange( a, b, c, d, e, f, g, h,  nrow= 2, top = "")+
theme(text=element_text(family="Arial",face="bold", size=9))
grid.arrange( a, b, c, d, e, f, g, H,  nrow= 2, top = "")+
theme(text=element_text(family="Arial",face="bold", size=9))
##############
#Load library
##############
library(ncdf4) # package for netcdf manipulation
library(raster) # package for raster manipulation
library(rgdal) # package for geospatial analysis
library(ggplot2) # package for plotting
#install.packages("weathermetrics")
library(weathermetrics)
library(rnaturalearth)
library(rnaturalearthdata)
help(weathermetrics)
#install.packages('ggplot2', dependencies = TRUE)
#install.packages('rlang')
##############
#open directory
##############
setwd("C:/Users/Met Eireann/Desktop/2OTH_&_ERA5/Newplots/Big/1887")
getwd()
#install.packages('ggplot2', dependencies = TRUE)
#install.packages('rlang')
##############
#open directory
##############
setwd("C:/Users/ckelly/Desktop/2OTH_&_ERA5/Newplots/Small/Ncep/1870S")
getwd()
T850_290676 <- "T850_2976.nc"
file.exists(T850_290676)
mslp_290676 <- "MSLP_290676.nc"
file.exists(mslp_290676)
#install.packages('ggplot2', dependencies = TRUE)
#install.packages('rlang')
##############
#open directory
##############
setwd("C:/Users/ckelly/Desktop/2OTH_&_ERA5/Newplots/Small/Ncep/1870S")
nc_data <- nc_open('T850_187617.nc')
lon <- ncvar_get(nc_data, "lon")
lon[lon > 180] <- lon[lon > 180] - 360
lat <- ncvar_get(nc_data, "lat", verbose = F)
t <- ncvar_get(nc_data, "time")
head(lon)
names(nc_data$dimvar)
ndvi.array <- ncvar_get(nc_data, "air") # store the data in a 3-dimensional array
dim(ndvi.array)
fillvalue <- ncatt_get(nc_data, "air", "_FillValue")
fillvalue
nc_close(nc_data)
ndvi.array[ndvi.array == fillvalue$value] <- NA
ndvi.slice <- ndvi.array
dim(ndvi.array)
r <- raster(t(ndvi.slice), xmn=min(lon), xmx=max(lon), ymn=min(lat), ymx=max(lat), crs=CRS("+proj=longlat +ellps=WGS84 +datum=WGS84 +no_defs+ towgs84=0,0,0"))
r <- flip(r, direction='y')
head(r)
nc_data_msl <- nc_open('MSLP_187617.nc')
names(nc_data_msl$var)
lon <- ncvar_get(nc_data_msl, "lon")
lon[lon > 180] <- lon[lon > 180] - 360
lat <- ncvar_get(nc_data_msl, "lat", verbose = F)
t <- ncvar_get(nc_data_msl, "time")
head(lon)
ndvi.array_msl <- ncvar_get(nc_data_msl, "prmsl") # store the data in a 3-dimensional array
dim(ndvi.array_msl)
fillvalue_msl <- ncatt_get(nc_data_msl, "prmsl", "_FillValue")
fillvalue_msl
nc_close(nc_data_msl)
ndvi.array_msl[ndvi.array_msl == fillvalue_msl$value] <- NA
ndvi.slice_msl <- ndvi.array_msl
dim(ndvi.array_msl)
r_msl <- raster(t(ndvi.slice_msl), xmn=min(lon), xmx=max(lon), ymn=min(lat), ymx=max(lat), crs=CRS("+proj=longlat +ellps=WGS84 +datum=WGS84 +no_defs+ towgs84=0,0,0"))
r_msl <- flip(r_msl, direction='y')
mslrasdf <-as.data.frame(r_msl, xy=TRUE)
head(mslrasdf)
mslrasdf$layer <-c (mslrasdf$layer /100 )
## run world package
world <- ne_coastline(scale = "large", returnclass = "sf")
class(world)
##Save raster layer as data frames
rasdf <-as.data.frame(r, xy=TRUE)
head(rasdf)
rasdf$layer <- kelvin.to.celsius(rasdf$layer)
names(nc_data$var)
##create ggplot object with layers
p<- ggplot()+
geom_raster(aes(x=x,y=y, fill = layer),data=rasdf)+
geom_sf(fill="transparent", data=world)+
scale_fill_viridis_c(limits = c(-5, 30 ),name="TEMP [Â°C]",direction=+1,option = "turbo")+
labs( x = "LONGITUDE", y = "LATITUDE") +
ggtitle("(17-07-1876)")+
coord_sf(xlim = c(-20, 5), ylim = c(60,48), expand = T)+
theme(text=element_text(family="Arial",face="bold", size=20))+
theme_bw()
###########
##Combine & overlay data frames in one ggplot object and plot
###########
#install.packages("rcartocolor")
#library(rcartocolor)
library(metR)
library(gridExtra)
library(grid)
A1876_07_17<- p +
geom_contour(aes(x=x,y=y,z=layer),color="black",size=0.0005,data=mslrasdf) +
geom_text_contour(aes(x=x,y=y,z = layer),color="black", data=mslrasdf) + theme(legend.position = "none")
A1876_07_17
